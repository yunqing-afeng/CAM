execute if entity @s[distance=..7] positioned ^ ^ ^ if block ~ ~ ~ minecraft:jukebox{RecordItem:{tag:{custom_music:1b}}} align xyz positioned ~0.5 ~ ~0.5 unless entity @e[type=minecraft:armor_stand,distance=..0.5,tag=foo_block] run summon minecraft:area_effect_cloud ~ ~ ~ {Tags:["music_block_pos"]}
execute if entity @s[distance=..7] unless entity @e[type=minecraft:area_effect_cloud,distance=..6,tag=music_block_pos] positioned ^ ^ ^0.005 anchored feet run function music:ray